@model prj_Traveldate_Core.ViewModels.CpasswordChangeViewModel
@{
    ViewData["Title"] = "passwordChange";
}

<div class="container mt-2">
    <div class="row">
        <div class="col-md-3">
            <div id="div1">
                <div class="cell" id="div3">
                    <div class="cell d-flex flex-column">
                        <img src="~/icons/User profile - border vector image.png" class="userIcon" />
                        <ul class="list-group leftarea mt-3">
                            <li class="list-group-item menuItem" data-content="subItem1"> <span><img style="height:50px;width:45px;padding-bottom:5px" src="~/icons/icon-hi-2(member).gif" /></span><b style="font-weight:bolder;font-size:19px;padding-top:-50px">@ViewBag.LastName@ViewBag.firstName</b></li>
                            <li class="list-group-item menuItem" data-content="subItem2" style="background-color:whitesmoke; margin-top:-10px">@ViewBag.level </li>
                        </ul>

                    </div>
                    <div class="cell" id="div2">
                        <ul class="list-group leftarea lgmenu mt-3">
                            <li class="list-group-item menuItem">@Html.ActionLink("基本資料設定", "basicInfo","Member","",new {@class="black-link"})</li>
                            <li class="list-group-item menuItem">@Html.ActionLink("密碼更改", "passwordChange","Member","",new {@class="black-link"}) </li>
                            <li class="list-group-item menuItem">@Html.ActionLink("優惠券清單", "couponList","Member","",new {@class="black-link"}) </li>
                            <li class="list-group-item menuItem">@Html.ActionLink("新增旅伴", "showCompanion","Member","",new {@class="black-link"}) </li>
                            <li class="list-group-item menuItem">@Html.ActionLink("收藏清單", "favoriteList","Member","",new {@class="black-link"}) </li>
                            <li class="list-group-item menuItem">@Html.ActionLink("會員訂單", "orderList","Member","",new {@class="black-link"}) </li>
                            <li class="list-group-item menuItem">@Html.ActionLink("我的評論", "commentList","Member","",new {@class="black-link"}) </li>
                            <li class="list-group-item menuItem">@Html.ActionLink("我的揪團", "forumList","Member","",new {@class="black-link"})</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- 右半邊 - 內容容器 -->
        <div class="col-md-9">
            <h3 class="mb-4"><b>密碼更改</b></h3>
            @using (Html.BeginForm("passwordChange", "Member", FormMethod.Post))
            {
                <div id="rightPanel">
                    <div class="form-group">
                        @Html.LabelFor(model=>model.MemberId)
                        @Html.EditorFor(model=>model.MemberId)
                    </div>

                    <div class="form-group"><label for="NewPassword">輸入新密碼</label>
                        @Html.EditorFor(model => model.txtNewPassword, new { htmlAttributes = new { @class = "form-control" } })
  
                    </div>

                    <div class="form-group"><label for="CheckPassword">確認新密碼</label>
                        @Html.EditorFor(model => model.txtCheckPassword, new { htmlAttributes = new { @class = "form-control" } })

                    </div>

                    <div class="form-group">
                        <div class="passwordposition1">
                            <input id="checkbox" type="checkbox" onclick="cbshow()" /> 隱藏密碼
                            <button style="margin-left:20px" type="submit" class="btn my-btn-primary" id="btnChangePassword" name="btnChangePassword">變更密碼</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <div id="errorDiv" style="color: red;"></div>
                    </div>

                </div>
            }
        </div>
    </div>

    <div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="successModalLabel">密码修改成功</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    恭喜！您的密码已成功修改。
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
                </div>

            </div>
        </div>
    </div>



</div>





@section scripts{
    <script>
        const txtNewPassword = document.getElementById('txtNewPassword');
        const txtCheckPassword = document.getElementById('txtCheckPassword');
        const btnChangePassword = document.getElementById('btnChangePassword');
        const errorDiv = document.getElementById('errorDiv');
        const checkbox = document.getElementById('checkbox');

        btnChangePassword.addEventListener('click', () => {
            if (txtNewPassword.value != txtCheckPassword.value) {
                errorDiv.textContent = "新密碼與確認新密碼不一致或空白，請再次確認後提交";
                setTimeout(() => {
                    errorDiv.textContent = "新密碼與確認新密碼不一致或空白，請再次確認後提交";
                }, 3000);
            }
            if (txtNewPassword.value == txtCheckPassword.value) {
                swal("密碼更改成功！", "", "success")
                setTimeout(() => {
                    
                }, 3000);
            }
        });

        checkbox.addEventListener('click', () => { 
            if (txtNewPassword.type === "text" && txtCheckPassword.type === "text") {
                txtNewPassword.type = "password";
                txtCheckPassword.type = "password";
            } else {
                txtNewPassword.type = "text";
                txtCheckPassword.type = "text";
            }
        });
    </script>
}







@*    <script>
        const txtNewPassword = document.getElementById('txtNewPassword');
        const txtCheckPassword = document.getElementById('txtCheckPassword');
        const ChangePassword = document.getElementById('btnChangePassword');
        const errorDiv = document.getElementById('errorDiv');
        const checkbox = document.getElementById('checkbox');

            ChangePassword.addEventListener('click',()=>{

            if (txtNewPassword.value != txtCheckPassword.value) {

                errorDiv.textContent = "新密碼與確認新密碼不一致，請再次確認後提交";
                //NewPassword.value = "";
                //CheckPassword.value = "";
            }
            else if (txtNewPassword.value == "" || txtCheckPassword.value == "" || txtNewPassword.value == "" && txtCheckPassword.value == "") {
                errorDiv.textContent = "新密碼與確認新密碼不得為空白，請確認後再次提交";
            }
            else {
                errorDiv.textContent = "";
                txtNewPassword.value = "";
                txtCheckPassword.value = "";
                swal("密碼更改成功！", "", "success");
            
            })

        //checkbox顯示密碼
        function cbshow() {
            //var x = document.getElementById("NewPassword");
            if (NewPassword.type === "password" && CheckPassword.type === "password") {
                NewPassword.type = "text"
                CheckPassword.type = "text"
            }
            else {
                NewPassword.type = "password"
                CheckPassword.type = "password"
            }
        }

    </script> *@

    @section Styles
    {
    <link rel="stylesheet" href="~/css/Member.css" asp-append-version="true" />
    }

